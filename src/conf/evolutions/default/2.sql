# --- !Ups

create table "VISUALIZERS" (
  "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
  "URI" VARCHAR NOT NULL,
  "TITLE" VARCHAR,
  "DESCRIPTION" VARCHAR,
  "INPUT_LABEL" VARCHAR NOT NULL,
  "DEFAULT_CONFIGURATION" VARCHAR,
  "PAYOLA_URL" VARCHAR NOT NULL,
  "CREATED" TIMESTAMP,
  "MODIFIED" TIMESTAMP
);
create table "VISUALIZERS_COMPATIBILITY" (
  "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
  "VISUALIZATION_ID" BIGINT,
  "VISUALIZER_ID" BIGINT,
  "IS_COMPATIBLE" BOOLEAN,
  "CREATED" TIMESTAMP,
  "MODIFIED" TIMESTAMP
);

alter table "VISUALIZERS_COMPATIBILITY"
  add constraint "VC_VISUALIZATION_FK"
  foreign key("VISUALIZATION_ID")
    references "VISUALIZATIONS"("ID")
    on update NO ACTION
    on delete NO ACTION;

alter table "VISUALIZERS_COMPATIBILITY"
  add constraint "VC_VISUALIZER_FK"
  foreign key("VISUALIZER_ID")
    references "VISUALIZERS"("ID")
    on update NO ACTION
    on delete NO ACTION;

create table "VISUALIZER_FEATURES" (
  "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
  "URI" VARCHAR NOT NULL,
  "TITLE" VARCHAR,
  "SIGNATURE" VARCHAR,
  "VISUALIZER_ID" BIGINT,
  "CREATED" TIMESTAMP,
  "MODIFIED" TIMESTAMP
);

alter table "VISUALIZER_FEATURES"
  add constraint "VF_VISUALIZER_FK"
  foreign key("VISUALIZER_ID")
    references "VISUALIZERS"("ID")
    on update NO ACTION
    on delete NO ACTION;

create table "VISUALIZER_FEATURES_COMPATIBILITY" (
  "ID" BIGINT GENERATED BY DEFAULT AS IDENTITY(START WITH 1) NOT NULL PRIMARY KEY,
  "VISUALIZATION_ID" BIGINT,
  "FEATURE_ID" BIGINT,
  "IS_COMPATIBLE" BOOLEAN,
  "CREATED" TIMESTAMP,
  "MODIFIED" TIMESTAMP
);

alter table "VISUALIZER_FEATURES_COMPATIBILITY"
  add constraint "VFC_VISUALIZATION_FK"
  foreign key("VISUALIZATION_ID")
    references "VISUALIZATIONS"("ID")
    on update NO ACTION
    on delete NO ACTION;

alter table "VISUALIZER_FEATURES_COMPATIBILITY"
  add constraint "VFC_VISUALIZER_FK"
  foreign key("FEATURE_ID")
    references "VISUALIZER_FEATURES"("ID")
    on update NO ACTION
    on delete NO ACTION;

# --- !Downs

alter table "VISUALIZERS_COMPATIBILITY" drop constraint "VC_VISUALIZER_FK";
alter table "VISUALIZERS_COMPATIBILITY" drop constraint "VC_VISUALIZATION_FK";
drop table "VISUALIZERS_COMPATIBILITY";
alter table "VISUALIZER_FEATURES" drop constraint "VFC_FEATURE_FK";
alter table "VISUALIZER_FEATURES" drop constraint "VFC_VISUALIZATION_FK";
drop table "VISUALIZER_FEATURES";
drop table "VISUALIZERS";